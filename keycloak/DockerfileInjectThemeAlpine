FROM alpine as downloader

RUN apk add git npm curl
WORKDIR /download
RUN git clone https://github.com/lukin/keywind.git
RUN chmod -R 777 /download

RUN curl -f https://get.pnpm.io/v6.16.js | node - add --global pnpm

WORKDIR /download/keywind
RUN pnpm install
RUN pnpm build


FROM samuel19982/keycloak_alpine:1.0.0-SNAPSHOT

# Add the theme
COPY --from=downloader --chown=keycloak:root  /download/keywind/theme /opt/keycloak/themes/